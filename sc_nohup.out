Loading toml file...
Checking toml file...[Seurat]
Checking toml file...[Dataset]
Checking toml file...[Meta Features]
==================================================
Running R script...Extract Seurat data...
Loading required package: SeuratObject
Loading required package: sp

Attaching package: ‘SeuratObject’

The following objects are masked from ‘package:base’:

    intersect, t

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::between()     masks data.table::between()
✖ tidyr::expand()      masks Matrix::expand()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::first()       masks data.table::first()
✖ purrr::flatten()     masks jsonlite::flatten()
✖ lubridate::hour()    masks data.table::hour()
✖ lubridate::isoweek() masks data.table::isoweek()
✖ dplyr::lag()         masks stats::lag()
✖ dplyr::last()        masks data.table::last()
✖ lubridate::mday()    masks data.table::mday()
✖ lubridate::minute()  masks data.table::minute()
✖ lubridate::month()   masks data.table::month()
✖ tidyr::pack()        masks Matrix::pack()
✖ lubridate::quarter() masks data.table::quarter()
✖ lubridate::second()  masks data.table::second()
✖ purrr::transpose()   masks data.table::transpose()
✖ tidyr::unpack()      masks Matrix::unpack()
✖ lubridate::wday()    masks data.table::wday()
✖ lubridate::week()    masks data.table::week()
✖ lubridate::yday()    masks data.table::yday()
✖ lubridate::year()    masks data.table::year()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
===================================================
load RDS data...
Extract data...
Save metadata...
Save metadata feature names...
Save umap embedding...
Save normalized counts...
Done! Data extraction is done! ^_^ ...
=================================================
Running python script...Prepare meta data...
Selected features: nCount_RNA,nFeature_RNA,sex,MajorCellTypes,updrs,Complex_Assignment,mmse,sample_id,case
============================================
============================================
Dataset path:  datasets/PD5D_MTG_snRNAseq
Kept features:  ['nCount_RNA', 'nFeature_RNA', 'sex', 'MajorCellTypes', 'updrs', 'Complex_Assignment', 'mmse', 'sample_id', 'case']
Rename features:  {'Complex_Assignment': 'SubCellTypes'}
Sample column:  sample_id
Cluster column:  Complex_Assignment
Condition column:  case
Checking inputs...
Loading metadata...
Renaming features...
Renaming cell id...
Processing cell metadata...
Processing sample metadata...
/mnt/data/projects/donglab/ruifeng_2025/SC_ST_AutoProcess/rename_meta_SC.py:141: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.
  sample_meta.fillna("", inplace=True)
Loading embedding ....
Renaming embeddings....
Sampling umap...
Loading expression data...(Takes a while...be patient...)
Renaming expression....
Grouping by gene... be patient...
Saving gene jsons...
Saving gene... be patient...
1000/35018
2000/35018
3000/35018
4000/35018
5000/35018
6000/35018
7000/35018
8000/35018
9000/35018
10000/35018
11000/35018
12000/35018
13000/35018
14000/35018
15000/35018
16000/35018
17000/35018
18000/35018
19000/35018
20000/35018
21000/35018
22000/35018
23000/35018
24000/35018
25000/35018
26000/35018
27000/35018
28000/35018
29000/35018
30000/35018
31000/35018
32000/35018
33000/35018
34000/35018
35000/35018
Calculating pseudo count...
Grouping by gene... be patient...
1000/35018
2000/35018
3000/35018
4000/35018
5000/35018
6000/35018
7000/35018
8000/35018
9000/35018
10000/35018
11000/35018
12000/35018
13000/35018
14000/35018
15000/35018
16000/35018
17000/35018
18000/35018
19000/35018
20000/35018
21000/35018
22000/35018
23000/35018
24000/35018
25000/35018
26000/35018
27000/35018
28000/35018
29000/35018
30000/35018
31000/35018
32000/35018
33000/35018
34000/35018
35000/35018
Done! Feature/Gene data processed and saved.
